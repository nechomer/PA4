re_null_ref_str:    "Runtime Error: Null pointer dereference!"
re_array_index_str: "Runtime Error: Array index out of bounds!"
re_array_alloc_str: "Runtime Error: Array allocation with non-positive array size!"
re_zero_div_str:    "Runtime Error: Division by zero!"
str1: "In Foo_rise"
str2: "In Foo_shine"
str3: "In Bar_rise"
str4: "In Bar_twinkle"

# class Foo
# Dispatch vector:
_DV_Foo: [_Foo_rise, _Foo_shine]
# Field offsets
# 1: x
# 2: y

# class Bar
# Dispatch vector:
_DV_Bar: [_Bar_rise, _Foo_shine, _Bar_twinkle]
# Field offsets
# 1: x
# 2: y
# 3: z


__checkNullRef:
	# a is a reference
	Move a, R0
	Compare 0, R0
	JumpTrue _rc_error_label1
	Return Rdummy
_rc_error_label1:
	Library __println(re_null_ref_str),Rdummy
	Library __exit(1),Rdummy

__checkArrayAccess:
	# a is an arry
	# i is an index register
	ArrayLength a, R0
	Compare i, R0
	JumpLE _rc_error_label2
	Move i, R0
	Compare 0, R0
	JumpL _rc_error_label2
	Return Rdummy
_rc_error_label2:
	Library __println(re_array_index_str),Rdummy
	Library __exit(1),Rdummy

__checkSize:
	# n is an array length
	Move n, R0
	Compare 0, R0
	JumpLE _rc_error_label3
	Return Rdummy
_rc_error_label3:
	Library __println(re_array_alloc_str),Rdummy
	Library __exit(1),Rdummy

__checkZero:
	# x is a value that should no be zero
	Move x, R0
	Compare 0, R0
	JumpTrue _rc_error_label4
	Return Rdummy
_rc_error_label4:
	Library __println(re_zero_div_str),Rdummy
	Library __exit(1),Rdummy

_Foo_rise:
Move str1, R1
Library __println(R1), Rdummy
Move x_23, R1
Library __printi(R1), Rdummy
Move 2, R0
Return R0

_Foo_shine:
Move str2, R1
Library __println(R1), Rdummy
Move x_24, R1
Library __printi(R1), Rdummy
Move 1, R0
Return R0


_ic_main:
Library __allocateObject(16), R0
MoveField _DV_Bar, R0.0
Move R0, f_26
Move f_26, R1
StaticCall __checkNullRef(a=R1),Rdummy
Move 1, R2
VirtualCall R1.0(x_23=R2), R0
Move f_26, R1
StaticCall __checkNullRef(a=R1),Rdummy
Move 2, R2
VirtualCall R1.1(x_24=R2), R0
Library __allocateObject(12), R0
MoveField _DV_Foo, R0.0
Move R0, f_26
Move f_26, R1
StaticCall __checkNullRef(a=R1),Rdummy
Move 4, R2
VirtualCall R1.0(x_23=R2), R0
Move f_26, R1
StaticCall __checkNullRef(a=R1),Rdummy
Move 5, R2
VirtualCall R1.1(x_24=R2), R0
Library __allocateObject(16), R0
MoveField _DV_Bar, R0.0
Move R0, b_27
Move b_27, R1
StaticCall __checkNullRef(a=R1),Rdummy
Move 3, R2
VirtualCall R1.2(x_28=R2), R0
Library __exit(0),Rdummy

_Bar_rise:
Move str3, R1
Library __println(R1), Rdummy
Move x_23, R1
Library __printi(R1), Rdummy
Move 3, R0
Return R0

_Bar_twinkle:
Move str4, R1
Library __println(R1), Rdummy
Move x_28, R1
Library __printi(R1), Rdummy
Move 4, R0
Return R0
